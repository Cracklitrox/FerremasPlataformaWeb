{% extends 'base_usuario.html' %}

{% load static %}
{% block css %}
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f9f9f9;
        margin: 0;
        padding: 0;
    }

    header {
        background-color: #007bff;
        color: #fff;
        text-align: center;
        padding: 1.5rem 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1 {
        margin: 0;
        font-size: 2rem;
    }

    main {
        padding: 2rem;
        max-width: 900px;
        margin: 2rem auto;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    h2 {
        color: #333;
        margin-top: 0;
        border-bottom: 2px solid #007bff;
        padding-bottom: 0.5rem;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1.5rem;
    }

    th, td {
        border: 1px solid #ddd;
        padding: 0.75rem;
        text-align: left;
    }

    th {
        background-color: #007bff;
        color: #fff;
    }

    .action-buttons {
        display: flex;
        justify-content: space-around;
        margin-top: 1rem;
    }

    .action-buttons button {
        flex: 1;
        margin: 0 0.5rem;
        padding: 0.75rem;
        font-size: 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .action-buttons .confirm {
        background-color: #28a745;
        color: #fff;
    }

    .action-buttons .confirm:hover {
        background-color: #218838;
    }

    .action-buttons .reject {
        background-color: #dc3545;
        color: #fff;
    }

    .action-buttons .reject:hover {
        background-color: #c82333;
    }

    button:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.5);
    }

    .form-section {
        margin-bottom: 2rem;
    }

    .form-section:last-of-type {
        margin-bottom: 0;
    }

    .details-row {
        display: none;
    }

    .details-row td {
        border-top: none;
        padding: 0;
    }

    .details-row .details-content {
        padding: 0.75rem;
        background-color: #f1f1f1;
        border: 1px solid #ddd;
        border-top: none;
    }

    /* CSS específico para el formulario de registrar entrega de productos */
    #registrar-entrega-form {
        background-color: #f8f9fa;
        padding: 1.5rem;
        border: 1px solid #ddd;
        border-radius: 8px;
    }

    #registrar-entrega-form label {
        display: block;
        margin-bottom: 0.5rem;
    }

    #registrar-entrega-form input {
        width: calc(100% - 1.5rem);
        margin-bottom: 1rem;
        padding: 0.5rem;
        border-radius: 4px;
        border: 1px solid #ddd;
    }

    #registrar-entrega-form button {
        background-color: #007bff;
        color: #fff;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    #registrar-entrega-form button:hover {
        background-color: #0056b3;
    }

    #registrar-entrega-form button:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.5);
    }
</style>
{% endblock %}

{% block title %}
Contador FERREMAS
{% endblock %}

{% block content %}
<header>
    <h1>Contador FERREMAS</h1>
</header>
<nav>
    <div class="nav-right">
        {% if request.session.is_contador_logged_in %}
        <form action="{% url 'cerrar_sesion_contador' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-warning" onclick="return confirm('¿Estás seguro que deseas cerrar sesión?');">Cerrar Sesión</button>
        </form>
        {% endif %}
    </div>
</nav>
<main>
    <section class="form-section">
        <h2>Confirmar Pagos por Transferencia</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Cliente</th>
                    <th>Monto</th>
                    <th>Fecha</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="transferencias-tbody">
                {% for compra in compras %}
                <tr id="compra-{{ compra.id }}">
                    <td>{{ compra.id }}</td>
                    <td>{{ compra.usuario.username }}</td>
                    <td>${{ compra.total }}</td>
                    <td>{{ compra.fecha_compra }}</td>
                    <td>
                        <button class="confirm" onclick="ocultarFila({{ compra.id }}); alert('Compra aprobada')">Confirmar</button>
                        <button class="reject" onclick="ocultarFila({{ compra.id }}); alert('Compra rechazada')">Rechazar</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>

    <section class="form-section">
        <h2>Registrar Entrega de Productos</h2>
        <form id="registrar-entrega-form" action="{% url 'registrar_entrega' %}" method="post">
            {% csrf_token %}
            <label for="numero-orden">Número de Orden:</label>
            <input type="text" id="numero-orden" name="numero-orden" required>
            
            <label for="cliente">Cliente:</label>
            <input type="text" id="cliente" name="cliente" required>

            <label for="fecha-entrega">Fecha de Entrega:</label>
            <input type="date" id="fecha-entrega" name="fecha-entrega" required>
            
            <button type="submit">Registrar Entrega</button>
        </form>
    </section>
</main>
{% endblock %}

{% block js %}
<script>
    function ocultarFila(id) {
        document.getElementById('compra-' + id).style.display = 'none';
    }
</script>
{% endblock %}